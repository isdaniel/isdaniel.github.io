<!DOCTYPE html>
<html lang="zh-tw">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"isdaniel.github.io","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言：Asp.net 是一個pipeline的模型 我覺得.Net Web工程師對於這個模型和IHttpHanlder,IHttpModule 要有基本的概念和理解. 理解這些管道除了可以讓我們節省許多不必要的資源浪費也可讓我們程式架構更加有條理. 就像我們在Asp.net MVC如果要寫權限驗證程式碼,雖然可以寫在Controller的Action中 但更好做法是我可以寫一個類別繼承Author">
<meta property="og:type" content="article">
<meta property="og:title" content="Asp.net HttpHandler vs HttpModule 詳細解說.">
<meta property="og:url" content="https://isdaniel.github.io/HttpHandler-HttpModule/index.html">
<meta property="og:site_name" content="石頭的coding之路">
<meta property="og:description" content="前言：Asp.net 是一個pipeline的模型 我覺得.Net Web工程師對於這個模型和IHttpHanlder,IHttpModule 要有基本的概念和理解. 理解這些管道除了可以讓我們節省許多不必要的資源浪費也可讓我們程式架構更加有條理. 就像我們在Asp.net MVC如果要寫權限驗證程式碼,雖然可以寫在Controller的Action中 但更好做法是我可以寫一個類別繼承Author">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://1.bp.blogspot.com/--nEyvA5pGLk/WXn6YudHYzI/AAAAAAACWLg/7N81JLv5SfYPMvYmGdUnNHg4_p3Shb5DACLcBGAs/s1600/overview.jpg">
<meta property="article:published_time" content="2019-06-11T19:16:37.000Z">
<meta property="article:modified_time" content="2025-06-23T23:48:59.203Z">
<meta property="article:author" content="Daniel Shih">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="Asp.net">
<meta property="article:tag" content="IHttpHanlder">
<meta property="article:tag" content="IHttpModule">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://1.bp.blogspot.com/--nEyvA5pGLk/WXn6YudHYzI/AAAAAAACWLg/7N81JLv5SfYPMvYmGdUnNHg4_p3Shb5DACLcBGAs/s1600/overview.jpg">

<link rel="canonical" href="https://isdaniel.github.io/HttpHandler-HttpModule/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Asp.net HttpHandler vs HttpModule 詳細解說. | 石頭的coding之路</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9964202165342528"
     crossorigin="anonymous"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZKF58CMZ8X"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-ZKF58CMZ8X');
  </script>
  <meta name="google-adsense-account" content="ca-pub-9964202165342528">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">石頭的coding之路</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Hello World</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-course">

    <a href="/Course/" rel="section"><i class="fa fa-fw fa-book"></i>Course</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags<span class="badge">132</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories<span class="badge">59</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives<span class="badge">183</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/HttpHandler-HttpModule/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Asp.net HttpHandler vs HttpModule 詳細解說.
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-06-11 19:16:37" itemprop="dateCreated datePublished" datetime="2019-06-11T19:16:37+00:00">2019-06-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-06-23 23:48:59" itemprop="dateModified" datetime="2025-06-23T23:48:59+00:00">2025-06-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C#</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/Asp-net/" itemprop="url" rel="index"><span itemprop="name">Asp.net</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/HttpHandler-HttpModule/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="HttpHandler-HttpModule/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>6k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>5 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p><code>Asp.net</code> 是一個<code>pipeline</code>的模型</p>
<p>我覺得<code>.Net Web工程師</code>對於這個模型和<code>IHttpHanlder</code>,<code>IHttpModule</code> 要有基本的概念和理解.</p>
<p>理解這些管道除了可以讓我們節省許多不必要的資源浪費也可讓我們程式架構更加有條理.</p>
<p>就像我們在<code>Asp.net MVC</code>如果要寫權限驗證程式碼,雖然可以寫在<code>Controller</code>的<code>Action</code>中</p>
<p>但更好做法是我可以寫一個類別繼承<code>AuthorizeAttribute</code>並<code>override</code> <code>OnAuthorization</code>方法並掛上此標籤.</p>
<p>所以更了解這些原理可以讓我們寫程式事半功倍.</p>
<h2 id="Asp-net-Application-Event-生命週期"><a href="#Asp-net-Application-Event-生命週期" class="headerlink" title="Asp.net Application Event 生命週期"></a>Asp.net Application Event 生命週期</h2><p>前面我們知道Asp.net是一個請求處理響應的管道而這個管道中微軟有提供許多點可以讓我們進行客製化的擴充程式撰寫</p>
<blockquote>
<p>事件可藉由<code>IHttpModule</code>來擴充註冊</p>
</blockquote>
<h3 id="Event事件名稱："><a href="#Event事件名稱：" class="headerlink" title="Event事件名稱："></a>Event事件名稱：</h3><p>官網列出可用事件很多，下面列出我有用過的幾個事件和其功用.</p>
<ul>
<li>BeginRequest</li>
<li>AuthorizeRequest</li>
<li>PostResolveRequestCache</li>
<li>MapRequestHandler</li>
<li>AcquireRequestState</li>
<li>PreRequestHandlerExecute</li>
<li>PostRequestHandlerExecute</li>
<li>EndRequest</li>
</ul>
<h3 id="事件方法說明："><a href="#事件方法說明：" class="headerlink" title="事件方法說明："></a>事件方法說明：</h3><ul>
<li><code>BeginRequest</code>: 已經啟動要求。如果要在要求前執行某個動作 (例如, 在每頁頁首顯示廣告橫幅), 請同步處理這個事件。</li>
<li><code>AuthorizeRequest</code>: 您可以在內部使用這個事件, 以實作授權機制 (例如, 將存取控制清單 (ACL) 儲存在資料庫, 而非存入檔案系統)。您也可以覆寫這個事件, 但無此必要。</li>
<li><code>PostResolveRequestCache</code>：當 ASP.NET 略過目前事件處理常式的執行並允許快取模組從快取中服務要求時發生。</li>
<li><code>MapRequestHandler</code>：ASP.NET 基礎結構會使用事件來判斷目前要求的要求處理常式。 如需詳細資訊</li>
<li><code>AcquireRequestState</code>: 工作階段狀態是擷取自狀態儲存區。如果要建置自已的狀態管理模組, 則可以同步處理這個事件, 以便從狀態儲存區擷取「工作階段」狀態。</li>
<li><code>PreRequestHandlerExecute</code>: 這個事件會在執行 HTTP 處理常式之前產生。</li>
<li>在介於<code>PreRequestHandlerExecute</code>和<code>PostRequestHandlerExecute</code>事件之間會執行<code>HttpHandler</code>程式碼.</li>
<li><code>PostRequestHandlerExecute</code>: 這個事件會在執行 HTTP 處理常式之後產生。</li>
<li><code>EndRequest</code>: 要求已完成。您可能想要建置偵錯模組, 以便收集要求的全部資訊, 然後再將資訊寫入網頁中。</li>
</ul>
<h2 id="IHttpHandler-和-IHttpModule-關係"><a href="#IHttpHandler-和-IHttpModule-關係" class="headerlink" title="IHttpHandler 和 IHttpModule 關係"></a>IHttpHandler 和 IHttpModule 關係</h2><p>用一句話簡述<code>IHttpHandler</code>和<code>IHttpModule</code></p>
<p>如果把Http請求當作火車那</p>
<ul>
<li><code>IHttpHandler</code>是火車的終點</li>
<li><code>IHttpModule</code>是沿路經過的站點</li>
</ul>
<p><code>IHttpHandler</code>和<code>IHttpModule</code>關係如 <a href="https://www.codeproject.com/Articles/335968/Implementing-HTTPHandler-and-HTTPModule-in-ASP-NET">Implementing HTTPHandler and HTTPModule in ASP.NET</a> 文章提到</p>
<p><img src="https://1.bp.blogspot.com/--nEyvA5pGLk/WXn6YudHYzI/AAAAAAACWLg/7N81JLv5SfYPMvYmGdUnNHg4_p3Shb5DACLcBGAs/s1600/overview.jpg" alt="img"></p>
<p>每個請求一定會通過所有被註冊的<code>IHttpModule</code>,而最終會執行一個<code>IHttpHandler</code>後進行返回.</p>
<p>我們常聽到的<code>Asp.net</code> <code>Webform</code>，<code>MVC</code>都是經過管道<code>Module</code>並執行相對應的<code>Handler</code>.</p>
<blockquote>
<p>所以HttpHanlder 和 HttpMoudule 搭配使用達到更強大的功能.</p>
</blockquote>
<h2 id="IHttpHandler"><a href="#IHttpHandler" class="headerlink" title="IHttpHandler"></a>IHttpHandler</h2><p><a href="https://docs.microsoft.com/zh-tw/dotnet/api/system.web.ihttphandler?view=netframework-4.8">MSDN</a>說明</p>
<blockquote>
<p>您可以撰寫自訂的 HTTP 處理常式來處理特定的預先定義的任何 Common Language Specification (CLS) 標準的語言中的 HTTP 要求的類型。 可執行程式碼中定義HttpHandler類別，而不是傳統的 ASP 或 ASP.NET Web 網頁，這些特定的要求回應。 HTTP 處理常式提供您一種低層級的要求和回應服務的 IIS Web 伺服器互動，以及大部分 ISAPI 擴充程式類似，但使用簡單的程式設計模型提供的功能。</p>
</blockquote>
<p><code>IHttpHandler</code>是一個可以讓我們實現的介面<br>裡面包含：</p>
<p><strong>屬性:</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> IsReusable &#123; <span class="keyword">get</span>; &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>取得值，指出另一個要求是否可以使用 <code>IHttpHandler</code> 執行個體。</p>
</blockquote>
<p><strong>方法:</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ProcessRequest</span>(<span class="params">HttpContext context</span>)</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>以實作 IHttpHandler 介面的自訂 HttpHandler 來啟用 HTTP Web 要求的處理。</p>
</blockquote>
<h2 id="IHttpModule"><a href="#IHttpModule" class="headerlink" title="IHttpModule"></a>IHttpModule</h2><p><a href="https://support.microsoft.com/en-us/help/307985/info-asp-net-http-modules-and-http-handlers-overview">MSDN</a>說明</p>
<blockquote>
<p>Modules are called before and after the handler executes. Modules enable developers to intercept, participate in, or modify each individual request. Modules implement the IHttpModule interface, which is located in the System.Web namespace.</p>
</blockquote>
<p>處理常式 (Handler) 在執行前後，會呼叫模組 (Module)。 模組可以讓開發人員攔截、參與或修改每個要求。</p>
<p>更印證了</p>
<blockquote>
<p>　如果把Http請求當作火車那</p>
<ul>
<li><code>IHttpHandler</code>是火車的終點</li>
<li><code>IHttpModule</code>是沿路經過的站點</li>
</ul>
</blockquote>
<p>要查看有哪寫<code>IHttpModule</code>或<code>IHttpHandler</code>被註冊可以看<code>applicationhost.config</code>檔案</p>
<blockquote>
<p>路徑：C:\Users[user]\Documents\IISExpress\config\applicationhost.config</p>
</blockquote>
<h2 id="自己建立一個-IHttpHandler"><a href="#自己建立一個-IHttpHandler" class="headerlink" title="自己建立一個 IHttpHandler"></a>自己建立一個 IHttpHandler</h2><p>在前面有說到每個Http請求的最終是為了給一個<code>HttpHander</code>來執行處理.</p>
<p>像我們常看到的</p>
<ul>
<li>ASP.NET page (*.aspx)</li>
<li>Web service (*.asmx)</li>
<li>Generic Web  (*.ashx)</li>
</ul>
<p>甚至是<code>MVC (MvcHandler)</code>都是實現於<code>IHttpHander</code>介面</p>
<p>這邊介紹如果要如何建立自己<code>HttpHander</code>.</p>
<h3 id="程式碼"><a href="#程式碼" class="headerlink" title="程式碼"></a>程式碼</h3><p>使用<code>IHttpHandler</code>須完成幾個步驟:</p>
<ol>
<li>建立一個類別實現<code>IHttpHander</code></li>
<li><code>Web.Config</code>註冊上面撰寫的<code>IHttpHandler</code></li>
</ol>
<h4 id="建立一個類別實現IHttpHander"><a href="#建立一個類別實現IHttpHander" class="headerlink" title="建立一個類別實現IHttpHander"></a>建立一個類別實現<code>IHttpHander</code></h4><p>繼承完<code>IHttpHandler</code>我們會實現兩個方法.</p>
<ol>
<li><code>ProcessRequest(HttpContext context)</code> 執行此次請求動作.</li>
<li><code>bool IsReusable &#123; get; &#125;</code> 是否要將此次請求加入快取中重用.</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyHttpHandler</span> : <span class="title">IHttpHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ProcessRequest</span>(<span class="params">HttpContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        context.Response.ContentType = <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line">        context.Response.Write(<span class="string">&quot;==================&lt;br/&gt;&quot;</span>);</span><br><span class="line">        context.Response.Write(<span class="string">&quot;Hello World&lt;br/&gt;&quot;</span>);</span><br><span class="line">        context.Response.Write(<span class="string">&quot;==================&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> IsReusable &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Web-Config註冊上面撰寫的IHttpHandler"><a href="#Web-Config註冊上面撰寫的IHttpHandler" class="headerlink" title="Web.Config註冊上面撰寫的IHttpHandler"></a><code>Web.Config</code>註冊上面撰寫的<code>IHttpHandler</code></h4><p>我們要在<code>Web.Config</code>中設定我們撰寫的<code>HttpHandler</code></p>
<p>這是一個範例:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">handlers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">add</span> <span class="attr">verb</span>=<span class="string">&quot;*&quot;</span> <span class="attr">name</span>=<span class="string">&quot;MyHttpHandler&quot;</span> <span class="attr">path</span>=<span class="string">&quot;*.cspx&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;HttpHandler_HttpModule.MyHttpHandler&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">handlers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>把<code>handlers</code>加入在<code>system.webServer</code>結點中.</p>
<p>裡面有幾個<code>Attribute</code></p>
<ul>
<li><code>verb</code>：請求動作 <code>GET,POST,PUT...</code>如果是<code>*</code>代表全部請請動作都合用.</li>
<li><code>path</code>：請求那些副檔名會執行此<code>HttpHandler</code></li>
<li><code>type</code>：註冊的<code>HttpHandler</code>類型.</li>
</ul>
<p>其中最要注意的是type Attribute.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">add</span> <span class="attr">verb</span>=<span class="string">&quot;*&quot;</span> <span class="attr">name</span>=<span class="string">&quot;MyHttpHandler&quot;</span> <span class="attr">path</span>=<span class="string">&quot;*.cspx&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;(namespace).(classname)&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>最後我們就可以請求 <code>http://xxxx/Mypage.cspx</code> 來試試看我們的結果.</p>
<h2 id="自己建立一個-IHttpModule"><a href="#自己建立一個-IHttpModule" class="headerlink" title="自己建立一個 IHttpModule"></a>自己建立一個 IHttpModule</h2><p>每個被註冊的<code>HttpModule</code>是Http請求必經之路.</p>
<ul>
<li><code>Asp.net MVC</code> 是透過<code>System.Web.Routing.UrlRoutingModule</code> 這個<code>HttpModule</code>來完成切入的.</li>
</ul>
<p>使用<code>IHttpModule</code>須完成幾個步驟:</p>
<ol>
<li>建立一個類別實現<code>IHttpModule</code></li>
<li><code>Web.Config</code>註冊上面撰寫的<code>IHttpModule</code></li>
</ol>
<h4 id="建立一個類別實現IHttpModule"><a href="#建立一個類別實現IHttpModule" class="headerlink" title="建立一個類別實現IHttpModule"></a>建立一個類別實現<code>IHttpModule</code></h4><p>這個範例會在頁面上顯示 IIS Pipeline Event的執行順序.</p>
<ol>
<li><code>public void Init(HttpApplication context)</code> 把 <code>HttpApplication</code> 中的event做擴充.</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyHttpModule</span>:<span class="title">IHttpModule</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Init</span>(<span class="params">HttpApplication context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        context.BeginRequest += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;BeginRequest&quot;</span>);</span><br><span class="line"></span><br><span class="line">        context.AuthorizeRequest += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;AuthorizeRequest&quot;</span>);</span><br><span class="line"></span><br><span class="line">        context.PostResolveRequestCache += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;PostResolveRequestCache&quot;</span>);</span><br><span class="line"></span><br><span class="line">        context.MapRequestHandler += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;MapRequestHandler&quot;</span>);</span><br><span class="line"></span><br><span class="line">        context.AcquireRequestState += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;AcquireRequestState&quot;</span>);</span><br><span class="line"></span><br><span class="line">        context.PreRequestHandlerExecute += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;PreRequestHandlerExecute&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//這中間執行IHttpHandler.</span></span><br><span class="line"></span><br><span class="line">        context.PostRequestHandlerExecute += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;PostRequestHandlerExecute&quot;</span>);</span><br><span class="line"></span><br><span class="line">        context.EndRequest += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;EndRequest&quot;</span>);</span><br><span class="line"></span><br><span class="line">        context.PreSendRequestHeaders += (sender, <span class="keyword">args</span>) =&gt; ShowStep(sender, <span class="string">&quot;PreSendRequestHeaders&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ShowStep</span>(<span class="params"><span class="built_in">object</span> app,<span class="built_in">string</span> eventName</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> http = (HttpApplication)app;</span><br><span class="line">        http.Response.Write(<span class="string">$&quot;Step <span class="subst">&#123;eventName&#125;</span>&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dispose</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Web-Config註冊上面撰寫的IHttpModule"><a href="#Web-Config註冊上面撰寫的IHttpModule" class="headerlink" title="Web.Config註冊上面撰寫的IHttpModule"></a><code>Web.Config</code>註冊上面撰寫的<code>IHttpModule</code></h4><p>註冊方法和<code>IHttpHander</code>很類似,一樣在<code>system.webServer</code>節點下加入<code>modules</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;MyHttpModule&quot;</span> <span class="attr">type</span>=<span class="string">&quot;HttpHandler_HttpModule.MyHttpModule&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a href="https://github.com/isdaniel/HttpHanlder_Vs_HttpModule">範例原始碼下載</a></p>
<h2 id="參考資料："><a href="#參考資料：" class="headerlink" title="參考資料："></a>參考資料：</h2><ul>
<li><a href="https://docs.microsoft.com/en-us/previous-versions/aspnet/bb398986(v=vs.100)#Features">https://docs.microsoft.com/en-us/previous-versions/aspnet/bb398986(v=vs.100)#Features</a></li>
<li><a href="https://support.microsoft.com/zh-tw/help/307985/info-asp-net-http-modules-and-http-handlers-overview">https://support.microsoft.com/zh-tw/help/307985/info-asp-net-http-modules-and-http-handlers-overview</a></li>
<li><a href="https://www.codeproject.com/Articles/335968/Implementing-HTTPHandler-and-HTTPModule-in-ASP-NET">https://www.codeproject.com/Articles/335968/Implementing-HTTPHandler-and-HTTPModule-in-ASP-NET</a></li>
</ul>
<p>__此文作者__：Daniel Shih(石頭)<br />__此文地址__： <a href="https://isdaniel.github.io/HttpHandler-HttpModule/">https://isdaniel.github.io/HttpHandler-HttpModule/</a> <br />__版權聲明__：本博客所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/tw/">CC BY-NC-SA 3.0 TW</a> 許可協議。轉載請註明出處！</p>

    </div>

    
    
    
      
  <div class="popular-posts-header">Related Posts</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/httphandler-httpmodule/" rel="bookmark">Asp.net HttpHandler vs HttpModule 詳細解說.</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/AwesomeProxy-Net/" rel="bookmark">【C#】 AOP輕型框架  AwesomeProxy.Net 介紹使用</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/InvoiceTW-Framework/" rel="bookmark">【財政部查詢類電子發票API】框架解說 C#</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/Ithelp-day1/" rel="bookmark">(開賽)Http 請求 Asp.net IIS伺服器架構 (第1天)</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/Ithelp-day10/" rel="bookmark">透過MvcRouteHandler取得呼叫IHttphandler (第10天)</a></div>
    </li>
  </ul>
<div style="text-align: center;">
    如果本文對您幫助很大，可<a href="https://www.jkos.com/">街口支付</a>斗內鼓勵石頭^^
</div>

<img src="https://i.imgur.com/1D2UpQk.png">


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/C/" rel="tag"># C#</a>
              <a href="/tags/Asp-net/" rel="tag"># Asp.net</a>
              <a href="/tags/IHttpHanlder/" rel="tag"># IHttpHanlder</a>
              <a href="/tags/IHttpModule/" rel="tag"># IHttpModule</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/httphandler-httpmodule/" rel="prev" title="Asp.net HttpHandler vs HttpModule 詳細解說.">
      <i class="fa fa-chevron-left"></i> Asp.net HttpHandler vs HttpModule 詳細解說.
    </a></div>
      <div class="post-nav-item">
    <a href="/ithelp-day1/" rel="next" title="(開賽)Http 請求 Asp.net IIS伺服器架構 (第1天)">
      (開賽)Http 請求 Asp.net IIS伺服器架構 (第1天) <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">前言：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Asp-net-Application-Event-%E7%94%9F%E5%91%BD%E9%80%B1%E6%9C%9F"><span class="nav-number">2.</span> <span class="nav-text">Asp.net Application Event 生命週期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Event%E4%BA%8B%E4%BB%B6%E5%90%8D%E7%A8%B1%EF%BC%9A"><span class="nav-number">2.1.</span> <span class="nav-text">Event事件名稱：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E4%BB%B6%E6%96%B9%E6%B3%95%E8%AA%AA%E6%98%8E%EF%BC%9A"><span class="nav-number">2.2.</span> <span class="nav-text">事件方法說明：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IHttpHandler-%E5%92%8C-IHttpModule-%E9%97%9C%E4%BF%82"><span class="nav-number">3.</span> <span class="nav-text">IHttpHandler 和 IHttpModule 關係</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IHttpHandler"><span class="nav-number">4.</span> <span class="nav-text">IHttpHandler</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IHttpModule"><span class="nav-number">5.</span> <span class="nav-text">IHttpModule</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%B7%B1%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B-IHttpHandler"><span class="nav-number">6.</span> <span class="nav-text">自己建立一個 IHttpHandler</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BC%8F%E7%A2%BC"><span class="nav-number">6.1.</span> <span class="nav-text">程式碼</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E9%A1%9E%E5%88%A5%E5%AF%A6%E7%8F%BEIHttpHander"><span class="nav-number">6.1.1.</span> <span class="nav-text">建立一個類別實現IHttpHander</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Web-Config%E8%A8%BB%E5%86%8A%E4%B8%8A%E9%9D%A2%E6%92%B0%E5%AF%AB%E7%9A%84IHttpHandler"><span class="nav-number">6.1.2.</span> <span class="nav-text">Web.Config註冊上面撰寫的IHttpHandler</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%B7%B1%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B-IHttpModule"><span class="nav-number">7.</span> <span class="nav-text">自己建立一個 IHttpModule</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E9%A1%9E%E5%88%A5%E5%AF%A6%E7%8F%BEIHttpModule"><span class="nav-number">7.0.1.</span> <span class="nav-text">建立一個類別實現IHttpModule</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Web-Config%E8%A8%BB%E5%86%8A%E4%B8%8A%E9%9D%A2%E6%92%B0%E5%AF%AB%E7%9A%84IHttpModule"><span class="nav-number">7.0.2.</span> <span class="nav-text">Web.Config註冊上面撰寫的IHttpModule</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99%EF%BC%9A"><span class="nav-number">8.</span> <span class="nav-text">參考資料：</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Daniel Shih"
      src="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
  <p class="site-author-name" itemprop="name">Daniel Shih</p>
  <div class="site-description" itemprop="description">好點子沒價值，有價值的是把好點子實現</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">183</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">132</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/isdaniel" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;isdaniel" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:dog8300228@gmail.com" title="Email → mailto:dog8300228@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>Email</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/profile.php?id=100001400319136" title="FaceBook → https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100001400319136" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i>FaceBook</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/5176071/d-shih" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;5176071&#x2F;d-shih" rel="noopener" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
      </span>
  </div>



<p><a href="https://stackoverflow.com/users/5176071/d-shih"><img alt="profile for D-Shih at Stack Overflow, Q&amp;A for professional and enthusiast programmers" height="58" src="https://stackoverflow.com/users/flair/5176071.png?theme=dark" title="profile for D-Shih at Stack Overflow, Q&amp;A for professional and enthusiast programmers" width="208" /> </a></p>

<div>
<a href="https://info.flagcounter.com/tORe"><img src="https://s01.flagcounter.com/count/tORe/bg_F1FF29/txt_000000/border_9DCCC4/columns_2/maxflags_10/viewers_0/labels_1/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>
</div>

Certifications：

<div data-iframe-width="150" data-iframe-height="270" data-share-badge-id="41c9e6a3-2a37-49e1-9a53-37e0bfa9e6e1" data-share-badge-host="https://www.credly.com"></div><script type="text/javascript" async src="//cdn.credly.com/assets/utilities/embed.js"></script>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Daniel Shih</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="Symbols count total">890k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">13:29</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v7.3.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri == 'https://isdaniel.github.io/HttpHandler-HttpModule/',]
      });
      });
  </script>

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://danielshih.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://isdaniel.github.io/HttpHandler-HttpModule/";
    this.page.identifier = "HttpHandler-HttpModule/";
    this.page.title = "Asp.net HttpHandler vs HttpModule 詳細解說.";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://danielshih.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
