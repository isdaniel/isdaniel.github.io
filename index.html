<!DOCTYPE html>
<html lang="zh-tw">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"isdaniel.github.io","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="好點子沒價值，有價值的是把好點子實現">
<meta property="og:type" content="website">
<meta property="og:title" content="石頭的coding之路">
<meta property="og:url" content="https://isdaniel.github.io/index.html">
<meta property="og:site_name" content="石頭的coding之路">
<meta property="og:description" content="好點子沒價值，有價值的是把好點子實現">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Daniel Shih">
<meta property="article:tag" content="c#,Asp.net,Asp.net MVC,source code,後端,WebApi,SQL,SQL Server">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://isdaniel.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>石頭的coding之路</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">石頭的coding之路</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Hello World</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-course">

    <a href="/Course/" rel="section"><i class="fa fa-fw fa-book"></i>Course</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags<span class="badge">121</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories<span class="badge">52</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives<span class="badge">179</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/tls-ssl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/tls-ssl/" class="post-title-link" itemprop="url">Understand TLS/SSL networking flow</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-11-11 22:30:11" itemprop="dateCreated datePublished" datetime="2024-11-11T22:30:11+00:00">2024-11-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ssl/" itemprop="url" rel="index"><span itemprop="name">ssl</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ssl/tls/" itemprop="url" rel="index"><span itemprop="name">tls</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/tls-ssl/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tls-ssl/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>3.9k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>4 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Foreword"><a href="#Foreword" class="headerlink" title="Foreword"></a>Foreword</h2><p>TLS (Transport Layer Security) is a cryptographic protocol that provides secure communication over a network, commonly used to secure HTTP traffic (i.e., HTTPS). Here’s a high-level overview of the TLS workflow, which includes handshake and data transfer phases.</p>
<p>After TCP handshake, it will execute TLS handshake if client require.</p>
<p>Below image is my experiment TLS (TLS 1.2) workflow from PostgreSQL server, Red-frame represent TCP 3 handshake, and yellow-frame represent TLS handshake.</p>
<p><img src="/images/tls-ssl/2024-11-11_15h17_11.png" alt="img"></p>
<p>In the beginning, client will send a request to require sslmode connection (SSL&#x2F;TLS), if server support it will reply (‘S’).</p>
<p><img src="/images/tls-ssl/2024-11-11_17h48_32.png" alt="img"></p>
<p>Eventually, processing below steps to do TLS handshake.</p>
<ol>
<li>ClientHello → 2. ServerHello → 3. Server Certificate → 4. ServerHelloDone → 5. Client Key Exchange</li>
</ol>
<h3 id="TLS-work-flow"><a href="#TLS-work-flow" class="headerlink" title="TLS work-flow"></a>TLS work-flow</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/tls-ssl/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/c_foreach/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/c_foreach/" class="post-title-link" itemprop="url">C language implement foreach</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-04-17 22:30:11" itemprop="dateCreated datePublished" datetime="2024-04-17T22:30:11+00:00">2024-04-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C#</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/DesignPattern/" itemprop="url" rel="index"><span itemprop="name">DesignPattern</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/c_foreach/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="c_foreach/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>3.7k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>3 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Foreword"><a href="#Foreword" class="headerlink" title="Foreword"></a>Foreword</h2><p>In PostgreSQL, there isn’t a native foreach loop construct in C, because C itself doesn’t have a foreach loop as you might find in higher-level languages like Python or PHP. However, PostgreSQL often implements loop iterations over elements using <strong>Macros</strong> that simplify the handling of data structures, such as linked lists, which are commonly used within its codebase.</p>
<h2 id="Common-Loop-Macros-in-PostgreSQL"><a href="#Common-Loop-Macros-in-PostgreSQL" class="headerlink" title="Common Loop Macros in PostgreSQL"></a>Common Loop Macros in PostgreSQL</h2><ol>
<li><p><code>lfirst(lc)</code>:</p>
<ul>
<li>This macro retrieves the data stored in a <code>ListCell</code>. The <code>ListCell</code> structure typically contains a union that can hold various types of pointers (like <code>void*</code>, <code>int</code>, etc.). The <code>ptr_value</code> is a generic pointer that can point to any node or structure, and <code>lfirst</code> simply casts it back from the <code>void *</code>.</li>
</ul>
</li>
<li><p><code>lfirst_node(type, lc)</code>:</p>
<ul>
<li>This macro is used when the list elements are known to be of a specific node type, which is common in the parser and planner where lists often contain specific types of nodes (e.g., expression or plan nodes). <code>lfirst_node</code> uses <code>castNode</code> to cast the pointer retrieved by <code>lfirst</code> to the specified type, ensuring type safety and readability in the code.</li>
</ul>
</li>
<li><p><code>castNode(_type_, nodeptr)</code>:</p>
<ul>
<li>A simple cast to the specified type <code>_type_</code>. It enhances readability and ensures that the casting is explicit in the code, which is crucial for understanding that a type conversion is taking place, particularly when navigating complex data structures common in PostgreSQL’s internals.</li>
</ul>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> lfirst(lc)				((lc)-&gt;ptr_value)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lfirst_node(type,lc)	castNode(type, lfirst(lc))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> castNode(_type_, nodeptr) ((_type_ *) (nodeptr))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> true	1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> false	0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> foreach(cell, lst)	\</span></span><br><span class="line"><span class="meta">	for (ForEachState cell##__state = &#123;(lst), 0&#125;; \</span></span><br><span class="line"><span class="meta">		 (cell##__state.l != NIL &amp;&amp; \</span></span><br><span class="line"><span class="meta">		  cell##__state.i <span class="string">&lt; cell##__state.l-&gt;</span>length) ? \</span></span><br><span class="line"><span class="meta">		 (cell = &amp;cell##__state.l-&gt;elements[cell##__state.i], true) : \</span></span><br><span class="line"><span class="meta">		 (cell = NULL, false); \</span></span><br><span class="line"><span class="meta">		 cell##__state.i++)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NIL						((List *) NULL)</span></span><br></pre></td></tr></table></figure>

<p>The <code>ListCell</code> union consists of a single member, <code>ptr_value</code>, which is a generic pointer <code>(void *)</code>.</p>
<p>This pointer can hold a reference to any type of data, allowing for flexibility in what kind of data the list can contain.<br>This structure is useful for managing lists of generic data types.</p>
<p>The List structure represents a dynamic list in PostgreSQL.<br>It contains:</p>
<ul>
<li><code>length</code>: An integer that specifies the current number of elements in the list.</li>
<li><code>elements</code>: A pointer to an array of <code>ListCell</code> elements, which holds the actual data in the list. This array can be re-allocated as the list grows or shrinks, allowing for dynamic resizing.</li>
<li>The comment suggests that sometimes <code>ListCell</code> elements may be allocated directly alongside the List structure itself. This can optimize memory usage and improve performance.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span> <span class="title">ListCell</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="type">void</span>	   *ptr_value;</span><br><span class="line">&#125; ListCell;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">List</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="type">int</span>			length;			<span class="comment">/* number of elements currently present */</span></span><br><span class="line">	ListCell   *elements;		<span class="comment">/* re-allocatable array of cells */</span></span><br><span class="line">&#125; List;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/c_foreach/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/postgresql-vscode-sourcecode-debugger/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/postgresql-vscode-sourcecode-debugger/" class="post-title-link" itemprop="url">How can we use vscode debug PostgreSQL running process by source code?</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-06-02 22:30:11" itemprop="dateCreated datePublished" datetime="2023-06-02T22:30:11+00:00">2023-06-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vscode/" itemprop="url" rel="index"><span itemprop="name">vscode</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vscode/postgresql/" itemprop="url" rel="index"><span itemprop="name">postgresql</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vscode/postgresql/debugger/" itemprop="url" rel="index"><span itemprop="name">debugger</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vscode/postgresql/debugger/sourcecode/" itemprop="url" rel="index"><span itemprop="name">sourcecode</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/postgresql-vscode-sourcecode-debugger/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="postgresql-vscode-sourcecode-debugger/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>5.8k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>5 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Foreword"><a href="#Foreword" class="headerlink" title="Foreword"></a>Foreword</h2><p>Using gdb for command-line debugging still feels inconvenient. I initially wanted to find a simpler way to directly debug the PostgreSQL source code under Windows. After searching for a while, I found that Visual Studio (VS) was the only option available, but it is heavy and the steps are quite complex. Since most real environments run on Linux, it is better to debug the PostgreSQL source code under Linux.</p>
<h2 id="How-to-build-install-PostgreSQL-from-source-code"><a href="#How-to-build-install-PostgreSQL-from-source-code" class="headerlink" title="How to build &amp; install PostgreSQL from source code."></a>How to build &amp; install PostgreSQL from source code.</h2><p>I used Ubuntu Linux environment, the first step we might need to install pre-requirement tool for PostgreSQL build.</p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> install build-essential libreadline-<span class="built_in">dev</span> zlib1g-<span class="built_in">dev</span> flex bison libxml2-<span class="built_in">dev</span> libxslt-<span class="built_in">dev</span> libssl-<span class="built_in">dev</span> libxml2-utils xsltproc ccache libsystemd-<span class="built_in">dev</span> -y</span><br></pre></td></tr></table></figure>

<p>download PostgreSQL source code.</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> https://ftp.postgresql.org/pub/source/v14.<span class="number">8</span>/postgresql-<span class="number">14</span>.<span class="number">8</span>.tar.gz</span><br><span class="line"><span class="attribute">tar</span> xvfz postgresql-<span class="number">14</span>.<span class="number">8</span>.tar.gz</span><br><span class="line"><span class="attribute">cd</span> postgresql-<span class="number">14</span>.<span class="number">8</span></span><br></pre></td></tr></table></figure>

<p>we would need to make sure the path (<code>--prefix</code>) exist in your system.  </p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">./configure</span> <span class="params">--prefix=/home/daniel/postgresql-14</span>.8/pgsql <span class="params">--with-icu</span> <span class="params">--with-openssl</span> <span class="params">--with-systemd</span> <span class="params">--with-libxml</span> <span class="params">--enable-debug</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#or debug -g3 mode</span></span><br><span class="line"></span><br><span class="line"><span class="string">./configure</span> <span class="params">--prefix=/home/daniel/postgresql-14</span>.8/pgsql <span class="params">--with-icu</span> <span class="params">--with-openssl</span> <span class="params">--with-systemd</span> <span class="params">--with-libxml</span> <span class="params">--enable-debug</span> CFLAGS=<span class="string">&quot;-DGCC_HASCLASSVISIBILITY -O0 -Wall -W -g3 -gdwarf-2&quot;</span></span><br><span class="line"></span><br><span class="line">make -j 8</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<blockquote>
<p>we must build with <code>--enable-debug</code> parameter, otherwise we can’t debug with our source code.</p>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/postgresql-vscode-sourcecode-debugger/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/azure-flexible-longterm-backup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/azure-flexible-longterm-backup/" class="post-title-link" itemprop="url">Azure PostgreSQL Flexible long term backup with Managed Identity</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-12-25 22:30:11" itemprop="dateCreated datePublished" datetime="2022-12-25T22:30:11+00:00">2022-12-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Azure/" itemprop="url" rel="index"><span itemprop="name">Azure</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Azure/flexibleServer/" itemprop="url" rel="index"><span itemprop="name">flexibleServer</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Azure/flexibleServer/Managed-Identity/" itemprop="url" rel="index"><span itemprop="name">Managed Identity</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/azure-flexible-longterm-backup/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="azure-flexible-longterm-backup/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>3.6k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>3 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>This ariticle will guide us how to do long-term backup (more than 35 days) on Azure PostgreSQL Flexible.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites:"></a>Prerequisites:</h2><ul>
<li>A Postgres flexible server and an Azure VM (Linux (ubuntu 20.04)) that has access to it.</li>
<li>A MI (Managed Identity) in your subscription.</li>
<li>Please kindly make sure backup Postgres flexible server version align with pg_dump version.</li>
</ul>
<p>Here is the sample code of Azure PostgreSQL Flexible long term backup with Managed Identity.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;start program&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;=====================&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;start installing postgresql client suit&#x27;</span></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt -y install postgresql-client</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;======================&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;postgresql client install ends&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;start mount storage&#x27;</span></span><br><span class="line"></span><br><span class="line">wget https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb</span><br><span class="line"><span class="built_in">sudo</span> dpkg -i packages-microsoft-prod.deb</span><br><span class="line"><span class="built_in">sudo</span> apt-get update</span><br><span class="line"><span class="built_in">sudo</span> apt-get install blobfuse -y</span><br><span class="line"><span class="built_in">sudo</span> apt-get install jq -y</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! -f blob.conf  ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;accountName &lt;&lt;Your blob accountName&gt;&gt;&#x27;</span> &gt;&gt; blob.conf </span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;authType MSI&#x27;</span> &gt;&gt; fuse_connection.cfg</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;identityObjectId &lt;&lt;Your blob accountKey&gt;&gt;&#x27;</span> &gt;&gt; blob.conf </span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;containerName &lt;&lt;Your blob Container Name&gt;&gt;&#x27;</span> &gt;&gt; blob.conf </span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#create a folder which can mount to blob</span></span><br><span class="line"><span class="built_in">mkdir</span> ~/data</span><br><span class="line"><span class="built_in">sudo</span> blobfuse ~/data --tmp-path=/mnt/resource/mycontainer  --config-file=./blob.conf -o attr_timeout=240 -o entry_timeout=240 -o negative_timeout=120</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;======= starting backup============&#x27;</span></span><br><span class="line">DNAME=`<span class="built_in">date</span> +%Y%m%d%H%M%S`</span><br><span class="line"><span class="built_in">export</span> PGPASSWORD=`curl -s <span class="string">&#x27;http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&amp;resource=https%3A%2F%2Fossrdbms-aad.database.windows.net&amp;client_id=&lt;&lt;MI client ID&gt;&gt;&#x27;</span> -H Metadata:<span class="literal">true</span> | jq -r .access_token`</span><br><span class="line">pg_dump --host=test-conn.postgres.database.azure.com --username=<span class="string">&#x27;MI-Demo&#x27;</span> -Fc -c  testdb &gt; ~/data/dump<span class="variable">$DNAME</span>.sql</span><br></pre></td></tr></table></figure>

<h2 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments:"></a>Experiments:</h2><h3 id="Here-is-the-guideline-for-using-managed-identity-to-connect-to-your-DB-server-in-VM"><a href="#Here-is-the-guideline-for-using-managed-identity-to-connect-to-your-DB-server-in-VM" class="headerlink" title="Here is the guideline for using managed identity to connect to your DB server in VM."></a>Here is the guideline for using managed identity to connect to your DB server in VM.</h3><p>We would make sure the Authentication setting that was PostgreSQL and Azure Active Directory authentication.</p>
<p><img src="https://i.imgur.com/BVNlWCx.png"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/azure-flexible-longterm-backup/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/postgresql-debug-source-code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/postgresql-debug-source-code/" class="post-title-link" itemprop="url">postgresql source code install</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-09-03 12:30:11" itemprop="dateCreated datePublished" datetime="2022-09-03T12:30:11+00:00">2022-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/postgresql/" itemprop="url" rel="index"><span itemprop="name">postgresql</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/postgresql-debug-source-code/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="postgresql-debug-source-code/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>5.3k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>5 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因為工作需要最近在研究 postgresql DB，postgresql DB 是一個 Open Source RDBMS，所以有任何問題疑問都可以把 source code 下載並 debug 了解原因，本篇希望可以快速幫助想要透過 source code 安裝 postgresql DB 的人</p>
<h3 id="Install-Postgresl"><a href="#Install-Postgresl" class="headerlink" title="Install Postgresl"></a>Install Postgresl</h3><p>假如你跟我一樣是 Ubuntu 在安裝前需要先把開發環境設定完畢，詳細資訊可參考 <a href="https://wiki.postgresql.org/wiki/Compile_and_Install_from_source_code">Postgresql Compile_and_Install_from_source_code</a></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt-get install build-essential libreadline-dev zlib1g-dev flex bison libxml2-dev libxslt-dev libssl-dev libxml2-utils xsltproc ccache</span><br></pre></td></tr></table></figure>

<p>我們可以透過 <a href="https://www.postgresql.org/ftp/source/">FTP Source Code</a> 要安裝 postgres source code 版本</p>
<p>假如我是要安裝 v12.9 的 postgres 版本，我會跑下面命令下載 source code &amp; 解壓縮</p>
<p>解壓縮完畢後，應該會在該目錄看到一個該版號資料夾裡面存放的就是該版本使用 Postgresql source code.</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://ftp.postgresql.org/pub/source/v12.<span class="number">9</span>/postgresql-<span class="number">12</span>.<span class="number">9</span>.tar.gz</span><br><span class="line">tar xvfz postgresql-<span class="number">12</span>.<span class="number">9</span>.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> postgresql-<span class="number">12</span>.<span class="number">9</span> </span><br></pre></td></tr></table></figure>

<p>利用 source code 安裝 postgres</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/postgresql-debug-source-code/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/aws-certified-ssa-experience/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/aws-certified-ssa-experience/" class="post-title-link" itemprop="url">AWS Certified Solutions Architect - Associate (SAA-C02) 考試重點與心得</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-06-26 12:00:00" itemprop="dateCreated datePublished" datetime="2022-06-26T12:00:00+00:00">2022-06-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AWS/" itemprop="url" rel="index"><span itemprop="name">AWS</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AWS/Certified/" itemprop="url" rel="index"><span itemprop="name">Certified</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/aws-certified-ssa-experience/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="aws-certified-ssa-experience/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>4.8k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>4 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>我算是一個雲端小白，自從進入目前公司後才開始接觸雲端相關概念並感受到雲端服務威力</p>
<p>我會想參加 SSA 考試主要有下面幾個原因</p>
<ol>
<li>主要是想趕在 SAA-C02 (2022-08) 換考試範圍前來測驗</li>
<li>感覺放在履歷上，增加職場競爭力</li>
<li>驗收自己目前對於雲端相關知識</li>
<li>目前在架構 Team 擔任工程師，希望規劃出好的系統架構</li>
</ol>
<p><img src="/../images/aws/2022-06-26_20h25_16.png" alt="img"></p>
<h2 id="考試重點"><a href="#考試重點" class="headerlink" title="考試重點"></a>考試重點</h2><h3 id="S3-考試必考"><a href="#S3-考試必考" class="headerlink" title="S3 (考試必考)"></a>S3 (考試必考)</h3><ul>
<li>S3 Standard</li>
<li>S3 IA (Infrequent Access)</li>
<li>Intelligent-Tiering：設計來優化成本，基於其自動移動 data 到相對便宜的 tier，不影響 performance，也不需提前處理。</li>
<li>S3 One Zone-IA</li>
<li>S3 Glacier：價格便宜，適合存放 Archive 檔案 (預設會加密)<ul>
<li>Instant Retrieval：最少存放 90 天</li>
<li>Flexible Retrieval (formerly S3 Glacier)：最少存放 90 天<ul>
<li>Expedited：1~5 min</li>
<li>Standard：3~5 hours</li>
<li>Bulk：5~12 hours</li>
</ul>
</li>
<li>Deep Archive - for long term storage: 最少存放 180 天  <ul>
<li>Standard：12 hours</li>
<li>Bulk：48 hours</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="重點功能"><a href="#重點功能" class="headerlink" title="重點功能"></a>重點功能</h4><p>S3 Lifecycle rule 控制 S3 存放物件存放規則 S3 Type，這樣可以讓S3使用費用更有效率</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/aws-certified-ssa-experience/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/aws-serverless/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/aws-serverless/" class="post-title-link" itemprop="url">Serverless + CloudFormation 撰寫 lambda</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-16 22:30:11" itemprop="dateCreated datePublished" datetime="2022-05-16T22:30:11+00:00">2022-05-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AWS/" itemprop="url" rel="index"><span itemprop="name">AWS</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AWS/Lambda/" itemprop="url" rel="index"><span itemprop="name">Lambda</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/aws-serverless/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="aws-serverless/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>2.4k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>2 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>AWS lambda 作為 serverless 服務，之前有介紹過 <a href="aws-first-lambda.md">AWS Lambda 初體驗 by .net core</a>，本次要介紹 <a href="https://www.serverless.com/framework/docs">serverless</a> 框架搭配 AWS <code>CloudFormation</code> (IaC)</p>
<p>Serverless 預設使用 provider 是 AWS</p>
<blockquote>
<p>AWS is the default cloud provider used by Serverless Framework.</p>
</blockquote>
<h2 id="建立第一個-serverless"><a href="#建立第一個-serverless" class="headerlink" title="建立第一個 serverless"></a>建立第一個 serverless</h2><p>本次案例我們利用 <a href="https://github.com/serverless/serverless#install-via-npm">serverless cli</a> 建立 dotnet template，利用 nqm 安裝 </p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g serverless</span><br></pre></td></tr></table></figure>

<p>安裝完後建立一個 dotnet core serverless project</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serverless create -t aws-csharp -n dotnetServerless</span><br></pre></td></tr></table></figure>

<p>本次使用參數說明</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/aws-serverless/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/postgresql-autovacuum/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/postgresql-autovacuum/" class="post-title-link" itemprop="url">Postgresql AutoVacuum 介紹</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-01-21 08:12:43" itemprop="dateCreated datePublished" datetime="2022-01-21T08:12:43+00:00">2022-01-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Postgresql/" itemprop="url" rel="index"><span itemprop="name">Postgresql</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Postgresql/Vacuum/" itemprop="url" rel="index"><span itemprop="name">Vacuum</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/postgresql-autovacuum/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="postgresql-autovacuum/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>7.3k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>7 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
            <img src="https://i.imgur.com/U1iC4ez.png" itemprop="contentUrl">
        </div>
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>AutoVacuum 在 Postgresql 是一個很重要的機制(甚至可以說最重要也不為過)，但裡面有些地方需要了解今天就帶大家初探</p>
<h2 id="資料-測試資料資訊"><a href="#資料-測試資料資訊" class="headerlink" title="資料 &amp; 測試資料資訊"></a>資料 &amp; 測試資料資訊</h2><p>本次執行 Sample Data</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> T1 (</span><br><span class="line">    ID <span class="type">INT</span> <span class="keyword">NOT NULL</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">	val <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col1 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col2 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col3 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col4 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col5 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col6 UUID <span class="keyword">NOT NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> T1</span><br><span class="line"><span class="keyword">SELECT</span> i,</span><br><span class="line">       RANDOM() <span class="operator">*</span> <span class="number">1000000</span>,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid</span><br><span class="line"><span class="keyword">FROM</span> generate_series(<span class="number">1</span>,<span class="number">20000000</span>) i;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> T2 (</span><br><span class="line">    ID <span class="type">INT</span> <span class="keyword">NOT NULL</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">	val <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col1 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col2 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col3 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col4 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col5 UUID <span class="keyword">NOT NULL</span>,</span><br><span class="line">	col6 UUID <span class="keyword">NOT NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> T2</span><br><span class="line"><span class="keyword">SELECT</span> i,</span><br><span class="line">       RANDOM() <span class="operator">*</span> <span class="number">1000000</span>,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid,</span><br><span class="line">	   md5(random()::text <span class="operator">||</span> clock_timestamp()::text)::uuid</span><br><span class="line"><span class="keyword">FROM</span> generate_series(<span class="number">1</span>,<span class="number">1000000</span>) i;</span><br><span class="line"></span><br><span class="line">vacuum ANALYZE T1;</span><br><span class="line">vacuum ANALYZE T2;</span><br></pre></td></tr></table></figure>

<p>查詢 sample code</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN (ANALYZE,TIMING <span class="keyword">ON</span>,BUFFERS <span class="keyword">ON</span>)</span><br><span class="line"><span class="keyword">SELECT</span> t1.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> T1 </span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> T2 <span class="keyword">ON</span> t1.id <span class="operator">=</span> t2.id </span><br><span class="line"><span class="keyword">WHERE</span> t1.id <span class="operator">&lt;</span> <span class="number">1000000</span> </span><br></pre></td></tr></table></figure>

<p>此次查詢如期走 <code>Merge Join</code></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&quot;Gather  (cost=1016.37..30569.85 rows=53968 width=104) (actual time=0.278..837.297 rows=999999 loops=1)&quot;</span><br><span class="line">&quot;  Workers Planned: 2&quot;</span><br><span class="line">&quot;  Workers Launched: 2&quot;</span><br><span class="line">&quot;  Buffers: shared hit=38273 read=21841&quot;</span><br><span class="line">&quot;  -&gt;  <span class="keyword">Merge</span> <span class="keyword">Join</span>  (cost=<span class="number">16.37</span>.<span class="number">.24173</span><span class="number">.05</span> rows=<span class="number">22487</span> width=<span class="number">104</span>) (actual time=<span class="number">11.993</span>.<span class="number">.662</span><span class="number">.770</span> rows=<span class="number">333333</span> loops=<span class="number">3</span>)<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>        <span class="keyword">Merge</span> Cond: (t2.id = t1.id)<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>        Buffers: shared hit=<span class="number">38273</span> read=<span class="number">21841</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>        -&gt;  Parallel <span class="keyword">Index</span> Only Scan <span class="keyword">using</span> t2_pkey <span class="keyword">on</span> t2  (cost=<span class="number">0.42</span>.<span class="number">.20147</span><span class="number">.09</span> rows=<span class="number">416667</span> width=<span class="number">4</span>) (actual time=<span class="number">0.041</span>.<span class="number">.69</span><span class="number">.947</span> rows=<span class="number">333333</span> loops=<span class="number">3</span>)<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>              Heap Fetches: <span class="number">0</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>              Buffers: shared hit=<span class="number">6</span> read=<span class="number">2732</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>        -&gt;  <span class="keyword">Index</span> Scan <span class="keyword">using</span> t1_pkey <span class="keyword">on</span> t1  (cost=<span class="number">0.44</span>.<span class="number">.48427</span><span class="number">.24</span> rows=<span class="number">1079360</span> width=<span class="number">104</span>) (actual time=<span class="number">0.041</span>.<span class="number">.329</span><span class="number">.874</span> rows=<span class="number">999819</span> loops=<span class="number">3</span>)<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>              <span class="keyword">Index</span> Cond: (id &lt; <span class="number">1000000</span>)<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>              Buffers: shared hit=<span class="number">38267</span> read=<span class="number">19109</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>Planning:<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>  Buffers: shared hit=<span class="number">4</span> read=<span class="number">8</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>Planning Time: <span class="number">0.228</span> ms<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>Execution Time: <span class="number">906.760</span> ms<span class="string">&quot;</span></span><br></pre></td></tr></table></figure>

<p>假如更新如多資料，但未觸發臨界值</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/postgresql-autovacuum/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/redis-cluster-introduce-01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/redis-cluster-introduce-01/" class="post-title-link" itemprop="url">Redis Cluster 介紹</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-01-12 08:12:43" itemprop="dateCreated datePublished" datetime="2022-01-12T08:12:43+00:00">2022-01-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Redis/" itemprop="url" rel="index"><span itemprop="name">Redis</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Redis/Cluster/" itemprop="url" rel="index"><span itemprop="name">Cluster</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/redis-cluster-introduce-01/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="redis-cluster-introduce-01/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>18k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>16 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
            <img src="https://i.imgur.com/8EUN7Vu.png" itemprop="contentUrl">
        </div>
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在巨量資料下，資料庫合理的分片(DB sharding)可以幫助我們承受更高量的資料量(前提Index還有設定都調教到很好在考慮 sharding)</p>
<p>而在 Redis 世界裡也有 redis cluster 來做 sharding 事情，今天就來跟大家分享介紹</p>
<p>我使用是 <a href="https://hub.docker.com/r/bitnami/redis-cluster/">bitnami redis-cluster</a> 這個 Image 來做這次 Poc</p>
<p>此案例是 3 master - 3 slave Redis server 範例</p>
<h2 id="建立-Redis-Cluster"><a href="#建立-Redis-Cluster" class="headerlink" title="建立 Redis Cluster"></a>建立 Redis Cluster</h2><h3 id="How-to-Use"><a href="#How-to-Use" class="headerlink" title="How to Use"></a>How to Use</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker-compose up -d</span></span><br></pre></td></tr></table></figure>

<p>跑完之後就會出現 6 台 Redis Container，如下表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE                       COMMAND                  CREATED          STATUS          PORTS                                       NAMES</span><br><span class="line">1a0c740cbb96   bitnami/redis-cluster:6.2   <span class="string">&quot;/opt/bitnami/script…&quot;</span>   31 seconds ago   Up 27 seconds   0.0.0.0:8105-&gt;6379/tcp, :::8105-&gt;6379/tcp   rediscluster_redis-node-5_1</span><br><span class="line">1651a81a286f   bitnami/redis-cluster:6.2   <span class="string">&quot;/opt/bitnami/script…&quot;</span>   37 seconds ago   Up 30 seconds   0.0.0.0:8102-&gt;6379/tcp, :::8102-&gt;6379/tcp   rediscluster_redis-node-2_1</span><br><span class="line">5d93edfc55e6   bitnami/redis-cluster:6.2   <span class="string">&quot;/opt/bitnami/script…&quot;</span>   37 seconds ago   Up 31 seconds   0.0.0.0:8104-&gt;6379/tcp, :::8104-&gt;6379/tcp   rediscluster_redis-node-4_1</span><br><span class="line">8ab5bbbb7364   bitnami/redis-cluster:6.2   <span class="string">&quot;/opt/bitnami/script…&quot;</span>   37 seconds ago   Up 29 seconds   0.0.0.0:8103-&gt;6379/tcp, :::8103-&gt;6379/tcp   rediscluster_redis-node-3_1</span><br><span class="line">8edf90bed3fb   bitnami/redis-cluster:6.2   <span class="string">&quot;/opt/bitnami/script…&quot;</span>   37 seconds ago   Up 29 seconds   0.0.0.0:8101-&gt;6379/tcp, :::8101-&gt;6379/tcp   rediscluster_redis-node-1_1</span><br><span class="line">e11ac0ec56aa   bitnami/redis-cluster:6.2   <span class="string">&quot;/opt/bitnami/script…&quot;</span>   37 seconds ago   Up 30 seconds   0.0.0.0:8100-&gt;6379/tcp, :::8100-&gt;6379/tcp   rediscluster_redis-node-0_1</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/redis-cluster-introduce-01/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://isdaniel.github.io/ndepend-code-quality/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
      <meta itemprop="name" content="Daniel Shih">
      <meta itemprop="description" content="好點子沒價值，有價值的是把好點子實現">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="石頭的coding之路">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/ndepend-code-quality/" class="post-title-link" itemprop="url">Ndepend 靜態分析 .Net 專案好物</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-04 00:00:00" itemprop="dateCreated datePublished" datetime="2021-12-04T00:00:00+00:00">2021-12-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-24 07:43:55" itemprop="dateModified" datetime="2024-12-24T07:43:55+00:00">2024-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C#</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/Ndepend/" itemprop="url" rel="index"><span itemprop="name">Ndepend</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/ndepend-code-quality/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="ndepend-code-quality/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>3k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>3 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>當一個專案越來越大，在開發新產品時同時要兼顧程式碼品質會越來越困難，今天要介紹的　<a href="https://www.ndepend.com/">Ndepend</a> 是一個很優秀靜態分析 .Net 專案好物</p>
<p>會幫我們產生一個 DashBoard 來了解目前專案大致上分析後的問題，並提供建議解法和處理方向，讓我們提前更快速抓出未來或目前存在 bug，減少發生需要晚上起來 support 機率，讓客戶，老闆，工程師都開心的三大歡喜</p>
<p>另外我們也可以透過 <a href="https://www.ndepend.com/">Ndepend</a> 來撰寫我們自己 Code Rule 並在 CI&#x2F;CD 流程中進行靜態掃描，讓我們出產軟體更有品質</p>
<p>本文我使用我自己的開源專案 <a href="https://github.com/isdaniel/ElectronicInvoice_TW">ElectronicInvoice_TW</a> 來當作分析案例</p>
<h2 id="建立-Ndepend-開始分析"><a href="#建立-Ndepend-開始分析" class="headerlink" title="建立 Ndepend 開始分析"></a>建立 Ndepend 開始分析</h2><p>安裝完 <code>Ndepend</code> 後我們可以在 virtual studio 上面的[延伸模組] 出現建立 <code>Ndepend</code> 項目，一開始我們利用 Attach New Ndepend Project to Current VS Solution ，來建立分析項目</p>
<p><img src="https://i.imgur.com/flzNRXR.png"></p>
<p><code>NDepend</code> 分析完程式後我們會在 sln 檔同級目錄下看到一個 <code>NDependOut</code> 資料夾跟 <code>.ndproj</code> 檔案</p>
<ul>
<li><code>.ndproj</code> 是 XML 格式儲存的專案檔，內容包含 <code>NDepend</code> 專案資訊及分析設定資訊</li>
<li><code>NDependOut</code> 資料夾中會有一個 <code>.ndar</code> 檔案這次一個二進制格式儲存的分析後結果</li>
<li><code>NDependOut</code> 中有一個 <code>NDependReport.html</code> 是一個分析後 Html 報表</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/ndepend-code-quality/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Daniel Shih"
      src="https://avatars0.githubusercontent.com/u/9159452?s=460&v=4">
  <p class="site-author-name" itemprop="name">Daniel Shih</p>
  <div class="site-description" itemprop="description">好點子沒價值，有價值的是把好點子實現</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">179</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">52</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">121</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/isdaniel" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;isdaniel" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:dog8300228@gmail.com" title="Email → mailto:dog8300228@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>Email</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/profile.php?id=100001400319136" title="FaceBook → https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100001400319136" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i>FaceBook</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/5176071/d-shih" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;5176071&#x2F;d-shih" rel="noopener" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
      </span>
  </div>



<p><a href="https://stackoverflow.com/users/5176071/d-shih"><img alt="profile for D-Shih at Stack Overflow, Q&amp;A for professional and enthusiast programmers" height="58" src="https://stackoverflow.com/users/flair/5176071.png?theme=dark" title="profile for D-Shih at Stack Overflow, Q&amp;A for professional and enthusiast programmers" width="208" /> </a></p>

<div>
<a href="https://info.flagcounter.com/tORe"><img src="https://s01.flagcounter.com/count/tORe/bg_F1FF29/txt_000000/border_9DCCC4/columns_2/maxflags_10/viewers_0/labels_1/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>
</div>

Certifications：

<div data-iframe-width="150" data-iframe-height="270" data-share-badge-id="41c9e6a3-2a37-49e1-9a53-37e0bfa9e6e1" data-share-badge-host="https://www.credly.com"></div><script type="text/javascript" async src="//cdn.credly.com/assets/utilities/embed.js"></script>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Daniel Shih</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="Symbols count total">872k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">13:12</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v7.3.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri == 'https://isdaniel.github.io/',]
      });
      });
  </script>

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://danielshih.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

</body>
</html>
